---
title: "elements"
date: "2024-12-31"
---
element å…ƒç´ 


è®©æˆ‘ä»¬æ·»åŠ æœç´¢ç»“æœé«˜äº®æ˜¾ç¤ºï¼Œå¹¶ä¼˜åŒ–æ— ç»“æœçš„æç¤ºï¼š

```typescript:app/posts/nextjs/ui/SearchBar.tsx
'use client'
import { useState } from 'react'
import Link from 'next/link';

interface Post {
    id: string;
    title: string;
    content: string;
    date: string;
    tags?: string[];
}

export default function SearchBar() {
    const [keyWord, setKeyWord] = useState<string>('');
    const [posts, setPosts] = useState<Post[]>([]);
    const [sortOrder, setSortOrder] = useState<'asc' | 'desc'>('desc');
    const [isLoading, setIsLoading] = useState(false);
    const [error, setError] = useState('');
    const [hasSearched, setHasSearched] = useState(false); // æ·»åŠ æœç´¢çŠ¶æ€æ ‡è®°

    // é«˜äº®æ˜¾ç¤ºæœç´¢å…³é”®è¯
    const highlightText = (text: string, keyword: string) => {
        if (!keyword.trim()) return text;
        
        const parts = text.split(new RegExp(`(${keyword})`, 'gi'));
        return parts.map((part, index) => 
            part.toLowerCase() === keyword.toLowerCase() ? (
                <span key={index} className="bg-yellow-200 font-medium">
                    {part}
                </span>
            ) : part
        );
    };

    const fetchResults = async (order: 'asc' | 'desc') => {
        if (!keyWord.trim()) return;
        
        setIsLoading(true);
        setError('');
        setHasSearched(true); // æ ‡è®°å·²è¿›è¡Œæœç´¢

        try {
            const response = await fetch('/posts/api/search', {
                method: "POST",
                headers: {
                    'Content-Type': "application/json"
                },
                body: JSON.stringify({
                    searchTerm: keyWord.trim(),
                    sortOrder: order
                })
            });

            const data = await response.json();
            
            if (data.code === 200) {
                setPosts(data.data);
            } else {
                setError(data.message || 'æœç´¢å¤±è´¥');
            }
        } catch (error) {
            console.error('æœç´¢é”™è¯¯:', error);
            setError('æœç´¢è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯');
        } finally {
            setIsLoading(false);
        }
    };

    // ... handleSortChange å’Œå…¶ä»–å‡½æ•°ä¿æŒä¸å˜ ...

    return (
        <div className="w-full max-w-2xl mx-auto">
            <div className="flex flex-col space-y-4">
                {/* æœç´¢è¾“å…¥æ¡†å’ŒæŒ‰é’®ç»„ä¿æŒä¸å˜ */}
                
                {/* æœç´¢ç»“æœåŒºåŸŸ */}
                {hasSearched && (
                    <div className="mt-8">
                        {isLoading ? (
                            <div className="text-center py-8">
                                <div className="inline-block animate-spin rounded-full h-8 w-8 border-4 border-blue-500 border-t-transparent"></div>
                                <p className="mt-2 text-gray-600">æœç´¢ä¸­...</p>
                            </div>
                        ) : posts.length > 0 ? (
                            <div className="space-y-4">
                                <p className="text-sm text-gray-600">
                                    æ‰¾åˆ° {posts.length} æ¡ç›¸å…³ç»“æœ
                                </p>
                                {posts.map((post) => (
                                    <div key={post.id} className="p-4 bg-white rounded-lg shadow hover:shadow-md transition-shadow">
                                        <h3 className="text-xl font-bold text-gray-800">
                                            {highlightText(post.title, keyWord)}
                                        </h3>
                                        <p className="text-sm text-gray-500 mt-1">
                                            å‘å¸ƒæ—¶é—´: {new Date(post.date).toLocaleDateString('zh-CN')}
                                        </p>
                                        <div className="mt-2 text-gray-600 line-clamp-3">
                                            {highlightText(post.content.substring(0, 200), keyWord)}
                                            {post.content.length > 200 && '...'}
                                        </div>
                                        {post.tags && post.tags.length > 0 && (
                                            <div className="flex gap-2 mt-2">
                                                {post.tags.map(tag => (
                                                    <span key={tag} className="px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded">
                                                        {tag}
                                                    </span>
                                                ))}
                                            </div>
                                        )}
                                        <Link
                                            href={`/posts/first?id=${post.id}`}
                                            className="text-blue-500 hover:text-blue-700 mt-3 inline-flex items-center group"
                                        >
                                            é˜…è¯»æ›´å¤š 
                                            <span className="ml-1 transform group-hover:translate-x-1 transition-transform">
                                                â†’
                                            </span>
                                        </Link>
                                    </div>
                                ))}
                            </div>
                        ) : (
                            <div className="text-center py-8">
                                <div className="text-gray-400 text-6xl mb-4">ğŸ”</div>
                                <h3 className="text-lg font-medium text-gray-900 mb-2">
                                    æœªæ‰¾åˆ°ç›¸å…³å†…å®¹
                                </h3>
                                <p className="text-gray-600">
                                    è¯•è¯•å…¶ä»–å…³é”®è¯ï¼Œæˆ–è€…æ£€æŸ¥æ˜¯å¦æœ‰æ‹¼å†™é”™è¯¯
                                </p>
                            </div>
                        )}
                    </div>
                )}
            </div>
        </div>
    );
}
```

ä¸»è¦æ”¹è¿›ï¼š

1. **é«˜äº®æ˜¾ç¤ºåŠŸèƒ½**ï¼š
```typescript
const highlightText = (text: string, keyword: string) => {
    if (!keyword.trim()) return text;
    
    const parts = text.split(new RegExp(`(${keyword})`, 'gi'));
    return parts.map((part, index) => 
        part.toLowerCase() === keyword.toLowerCase() ? (
            <span key={index} className="bg-yellow-200 font-medium">
                {part}
            </span>
        ) : part
    );
};
```

2. **æœç´¢çŠ¶æ€ç®¡ç†**ï¼š
```typescript
const [hasSearched, setHasSearched] = useState(false);
```

3. **åŠ è½½çŠ¶æ€æ˜¾ç¤º**ï¼š
```typescript
{isLoading && (
    <div className="text-center py-8">
        <div className="inline-block animate-spin rounded-full h-8 w-8 border-4 border-blue-500 border-t-transparent"></div>
        <p className="mt-2 text-gray-600">æœç´¢ä¸­...</p>
    </div>
)}
```

4. **æ— ç»“æœæç¤º**ï¼š
```typescript
{hasSearched && !isLoading && posts.length === 0 && (
    <div className="text-center py-8">
        <div className="text-gray-400 text-6xl mb-4">ğŸ”</div>
        <h3 className="text-lg font-medium text-gray-900 mb-2">
            æœªæ‰¾åˆ°ç›¸å…³å†…å®¹
        </h3>
        <p className="text-gray-600">
            è¯•è¯•å…¶ä»–å…³é”®è¯ï¼Œæˆ–è€…æ£€æŸ¥æ˜¯å¦æœ‰æ‹¼å†™é”™è¯¯
        </p>
    </div>
)}
```

è¿™äº›æ”¹è¿›æä¾›äº†ï¼š
- æœç´¢å…³é”®è¯é«˜äº®æ˜¾ç¤º
- æ›´å¥½çš„åŠ è½½çŠ¶æ€æç¤º
- ä¼˜é›…çš„æ— ç»“æœæç¤º
- æœç´¢ç»“æœæ•°é‡æ˜¾ç¤º
- æ›´å¥½çš„è§†è§‰åé¦ˆ

éœ€è¦æˆ‘è§£é‡Šä»»ä½•å…·ä½“éƒ¨åˆ†å—ï¼Ÿ
