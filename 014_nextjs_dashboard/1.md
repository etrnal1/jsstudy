## 创建pnpm包
    我们建议使用 pnpm 作为您的包管理器，因为它比 npm 或 yarn 更快、更高效。如果你没有安装 pnpm，你可以通过运行以下命令来全局安装它：

```
npm install -g pnpm
```
## 构建dashboard模版
npx create-next-app@latest nextjs-dashboard --example "https://github.com/vercel/next-learn/tree/main/dashboard/starter-example" --use-pnpm


## 创建 create-next-app --example 
此命令使用 create-next-app，这是一个命令行界面 （CLI） 工具，可为您设置 Next.js 应用程序。在上面的命令中，您还在本课程的入门示例中使用了 --example 标志。

## 目录结构
app     // 包含应用陈谷的所有路由,组件和逻辑
    -lib  //应用程序使用的函数  //应用程序的ui,卡片,表格和表单
    -ui
public  //应用程序的公共目录
scripts
next.config.js

## 运行开发服务器
### 安装项目的包
pnpm  i 

## 运行服务器

pnpm dev  -p 5000


## css 样式

添加css 到Layout.ts 完成全局样式

    global.css 里面有相关的tailwindcss 指令

### tailwindcss 

    一个css框架，允许在tsx会计编写实用程序类，加快开发流程
    

## 改变用户权限

-rwxr-xr-x@  1 mac  staff    696 11 19 18:50 tsconfig.json
-rwxr-xr-x@  1 mac  staff    649 11 19 18:50 tailwind.config.ts
-rwxr-xr-x@  1 mac  staff     83 11 19 18:50 postcss.config.js
-rwxr-xr-x@  1 mac  staff    966 11 19 18:50 package.json
-rwxr-xr-x@  1 mac  staff    133 11 19 18:50 next.config.ts
-rwxr-xr-x@  1 mac  staff    266 11 19 18:50 README.md
drwxr-xr-x@  8 mac  staff    256 11 28 15:58 app
drwxr-xr-x@  7 mac  staff    224 11 28 15:58 public
-rwxr-xr-x@  1 mac  staff  65940 11 28 15:58 pnpm-lock.yaml
drwxr-xr-x@ 21 mac  staff    672 11 28 15:58 node_modules
-rwxr-xr-x@  1 mac
### 使用chown 看用户权限
sudo chown -R mac  nextjs-dashboard/*


## 使用clsx 切换类名

假设您要创建一个接受 status 的 InvoiceStatus 组件。状态可以是“待处理”或“已付款”。
如果是 'paid' 的，则您希望颜色为绿色。 如果它是 'pending'，则您希望颜色为灰色

```javascript
    import clsx from 'clsx';
 
export default function InvoiceStatus({ status }: { status: string }) {
  return (
    <span
      className={clsx(
        'inline-flex items-center rounded-full px-2 py-1 text-sm',
        {
          'bg-gray-100 text-gray-500': status === 'pending',
          'bg-green-500 text-white': status === 'paid',
        },
      )}
    >
    // ...
)}
```
# 第三章

    How to add custom fonts with next/font.
如何使用 next/font 添加自定义字体。

How to add images with next/image.
如何使用 next/image 添加图像。

How fonts and images are optimized in Next.js.
如何在 Next.js 中优化字体和图像。


添加 p元素

  <p className={`${lusitana.className} text-3xl text-pink-500`}>娃哈哈</p>



  ## 链接
    https://nextjs.org/learn/dashboard-app/optimizing-fonts-images

  ## 创建页面
  dashboard/invo 
  dashborad/cus

  ## 创建仪表板布局

  import SideNav from "../ui/dashboard/sidenav";

export default function Layout({ children }: { children: React.ReactNode }) {
  return (
    <div className="flex h-screen flex-col md:flex-row md:overflow-hidden">
        {/* 小屏幕 侧边栏占满容器  侧边栏固定,不随内容伸缩 中等及以上屏幕,侧边栏宽度固定为16 rem*/}
      <div className="w-full flex-none md:w-64">
        <SideNav />
      </div>
      {/* 让主内容区域占用 */}
      <div className="flex-grow p-6 md:overflow-y-auto md:p-12">
        {children}
      </div>
    </div>
  );
}

为了改善导航体验，Next.js 会自动按路由段拆分您的应用程序。这与传统的 React SPA 不同，在传统的 React SPA 中，浏览器在初始加载时加载所有应用程序代码。

按路由拆分代码意味着页面变得孤立。如果某个页面引发错误，应用程序的其余部分仍将正常工作。


## 配置数据库

 选择vercel,配置项目,选择posgres 相关数据库,
 
## 安装pg 扩展
  pnpm 安装相应扩展
 pnpm i @vercel/postgres

## app 中有一个seed的文件夹
routes.tsx 有个数据库的种子


## 导入数据成功

localhost:5001/seed/ 
{"message":"Database seeded successfully"}


## 创建dashboard 主页


## 创建完后

/app/lib/data.js 里面加载获取数据的方法，从pg 里面查询到的相关数据
依次等待上面函数执行完后，然后执行函数函数，为阻塞


## 访问gitlab

## 访问github 
## 生成新令牌

https://github.com/settings/tokens
  必须使用令牌数据才能推送,输入普通密码数据无法完成推送

## gitlab镜像仓库密码填写这个新生成的即可完成推送


## 并行获取数据

Promise.all  和
Promise.allSettled() 函数同时启动所有Promise,例如在fetchCardData()中使用函数
promise.all()


在处理过程中遇到了特殊字符问题，我将修复问题并直接提供您可以复制的完整文档内容：

Next.js 流式渲染与页面加载性能问题整理

日期：2024-12-02

问题 1: 是否需要删除代码中的 setTimeout？

在代码中，fetchRevenue 函数使用了以下延迟代码：

await new Promise((resolve) => setTimeout(resolve, 3000));

答复：

是的，这段代码应该被移除，尤其是在生产环境中。这段人为延迟代码会阻塞数据加载，直接导致页面的加载速度变慢。你可以通过以下方法处理：
	1.	直接删除延迟：

// 删除这段代码
await new Promise((resolve) => setTimeout(resolve, 3000));


	2.	在开发环境中保留调试：
如果需要在开发中测试延迟，可以使用以下条件：

if (process.env.NODE_ENV !== 'production') {
    await new Promise((resolve) => setTimeout(resolve, 3000));
}

问题 2: 为什么 Next.js 的流式渲染中页面仍然加载较慢？

答复：

Next.js 流式渲染的目标是让页面“秒开”，即便有数据加载，也会优先渲染页面的骨架部分。但如果页面的核心组件依赖某些阻塞数据请求（例如 fetchRevenue 中的延迟），页面整体的加载性能仍会受到影响。

流式渲染的核心机制：
	1.	优先显示页面框架： 快速加载页面的静态内容或骨架屏。
	2.	分块加载动态数据： 数据通过分块逐步传输到客户端。
	3.	数据加载完成后更新页面： 占位符会被真实数据替换。

问题 3: 流式渲染是否仍需等待所有数据加载完成？

答复：

不完全需要。

流式渲染的主要特点是：
	1.	页面框架可以“秒开”，即使数据加载未完成，骨架屏和静态内容也会优先呈现。
	2.	动态数据会在加载完成后逐步替换占位符，形成完整的页面。

例如：

import { Suspense } from 'react';

function RevenueComponent() {
  const revenue = await fetchRevenue();
  return <p>Total Revenue: {revenue.total}</p>;
}

export default function Page() {
  return (
    <div>
      <h1>Dashboard</h1>
      <Suspense fallback={<p>Loading revenue...</p>}>
        <RevenueComponent />
      </Suspense>
    </div>
  );
}

效果：
	•	标题 Dashboard 会立刻显示。
	•	Revenue 部分会先显示“Loading…”，然后替换为数据内容。

问题 4: 如何优化页面渲染速度？

	1.	移除阻塞代码： 删除 setTimeout 等人为延迟。
	2.	并发加载数据： 使用 Promise.all 提高数据请求效率。

const [revenue, invoices] = await Promise.all([
    fetchRevenue(),
    fetchLatestInvoices(),
]);


	3.	使用骨架屏或占位符：
在 loading.tsx 或 Suspense 的 fallback 中展示临时内容，提升用户体验。
	4.	优化数据库查询：
减少查询时间，避免不必要的字段或复杂查询逻辑。

总结

流式渲染的核心优势是“先显示，后加载”。通过以下方法可以实现真正的“秒开”体验：
	1.	避免阻塞代码（如延迟）。
	2.	提供良好的骨架屏设计。
	3.	并行处理数据请求。